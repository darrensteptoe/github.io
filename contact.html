<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Videography Inquiry — Darren Steptoe</title>
  <meta name="description" content="Videography inquiry form for Drift Stone Videography Services." />
  <link rel="stylesheet" href="./styles.css" />
</head>

<body>
  <main class="wrap">

    <header class="header">
      <h1 class="title">Videography Services</h1>
      <p class="sub">Please fill out the form below and I’ll follow up within 48 hours.</p>
    </header>

    <section class="panel" aria-label="Directory">
      <h2 class="h2">Pages</h2>
      <ul class="links">
        <li><a href="./index.html">Home</a></li>
        <li><a href="./work.html">Work</a></li>
        <li><a href="./books.html">Books</a></li>
        <li><a href="./fantasy.html">Fantasy</a></li>
      </ul>
    </section>

    <section class="panel" aria-label="Videography inquiry form">
      <h2 class="h2">Inquiry Form</h2>

      <form
        id="contactForm"
        action="https://formspree.io/f/xdalazpw"
        method="POST"
        class="contactForm"
        novalidate
      >
        <label>
          Name *
          <input type="text" name="name" autocomplete="name" required>
        </label>

        <label>
          Telephone *
          <input type="tel" name="telephone" autocomplete="tel" inputmode="tel" required>
        </label>

        <label>
          Email *
          <input type="email" name="email" autocomplete="email" required>
        </label>

        <label>
          Date of Event *
          <input type="date" name="date_of_event" required>
        </label>

        <label>
          Event Type *
          <select id="eventTypeSelect" name="event_type" required>
            <option value="" selected disabled>Select one…</option>
            <option>Wedding &amp; Pre-Wedding</option>
            <option>Interview</option>
            <option>Event Videography</option>
            <option>Product &amp; Commercial</option>
            <option>Architectural &amp; Interior</option>
            <option>Birthday &amp; Anniversary</option>
            <option value="Other">Other</option>
          </select>
        </label>

        <label id="eventTypeOtherWrap" style="display:none;">
          Please specify *
          <input
            type="text"
            id="eventTypeOther"
            name="event_type_other"
            placeholder="Type here…"
            autocomplete="off"
          >
        </label>

        <label>
          Details *
          <textarea name="details" rows="6" required placeholder="Share the key details (location, hours needed, deliverables, vibe, etc.)"></textarea>
        </label>

        <label>
          Promo Code
          <input type="text" name="promo_code" autocomplete="off">
        </label>

        <!-- Honeypot spam filter -->
        <div class="hp" aria-hidden="true">
          <label>
            Leave this field empty
            <input type="text" name="_gotcha" tabindex="-1" autocomplete="off">
          </label>
        </div>

        <button id="submitBtn" type="submit">Send</button>

        <p id="formStatus" class="formStatus" role="status" aria-live="polite"></p>
      </form>
    </section>

    <footer class="footer">
      <p>© <span id="year"></span> Darren Steptoe</p>
    </footer>

  </main>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    (function () {
      const form = document.getElementById("contactForm");
      const statusEl = document.getElementById("formStatus");
      const btn = document.getElementById("submitBtn");

      const eventTypeSelect = document.getElementById("eventTypeSelect");
      const eventTypeOtherWrap = document.getElementById("eventTypeOtherWrap");
      const eventTypeOther = document.getElementById("eventTypeOther");

      function setStatus(msg, kind) {
        statusEl.textContent = msg || "";
        statusEl.dataset.kind = kind || "";
      }

      function disableForm(disabled) {
        btn.disabled = disabled;
        Array.from(form.elements).forEach(el => {
          if (el.tagName === "BUTTON") return;
          el.disabled = disabled;
        });
      }

      eventTypeSelect.addEventListener("change", () => {
        if (eventTypeSelect.value === "Other") {
          eventTypeOtherWrap.style.display = "block";
          eventTypeOther.setAttribute("required", "required");
        } else {
          eventTypeOtherWrap.style.display = "none";
          eventTypeOther.removeAttribute("required");
          eventTypeOther.value = "";
        }
      });

      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        // Required validation (non-radio)
        const requiredEls = form.querySelectorAll("[required]");
        for (const el of requiredEls) {
          if (!String(el.value || "").trim()) {
            setStatus("Please fill out all required fields (*).", "error");
            el.focus();
            return;
          }
        }

        // If Event Type = Other, ensure text is provided
        if (eventTypeSelect.value === "Other" && !eventTypeOther.value.trim()) {
          setStatus("Please specify your event type.", "error");
          eventTypeOther.focus();
          return;
        }

        // Honeypot hit -> silently drop
        const gotcha = form.querySelector('input[name="_gotcha"]');
        if (gotcha && gotcha.value.trim()) {
          form.reset();
          eventTypeOtherWrap.style.display = "none";
          eventTypeOther.removeAttribute("required");
          setStatus("✅ Submitted. I’ll follow up within 48 hours.", "success");
          return;
        }

        setStatus("Sending…", "info");
        disableForm(true);

        try {
          const data = new FormData(form);

          // Combine Other into event_type for the email you receive
          if (eventTypeSelect.value === "Other") {
            data.set("event_type", "Other: " + eventTypeOther.value.trim());
          }

          const res = await fetch(form.action, {
            method: "POST",
            body: data,
            headers: { "Accept": "application/json" }
          });

          if (res.ok) {
            form.reset();
            eventTypeOtherWrap.style.display = "none";
            eventTypeOther.removeAttribute("required");
            setStatus("✅ Submitted. I’ll follow up within 48 hours.", "success");
          } else {
            let errMsg = "Something went wrong. Please try again.";
            try {
              const json = await res.json();
              if (json && json.errors && json.errors.length) {
                errMsg = json.errors.map(e => e.message).join(" ");
              }
            } catch (_) {}
            setStatus(errMsg, "error");
          }
        } catch (err) {
          setStatus("Network error. Please try again in a moment.", "error");
        } finally {
          disableForm(false);
        }
      });
    })();
  </script>

</body>
</html>
