<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Videography Inquiry — Darren Steptoe</title>
  <meta name="description" content="Videography inquiry form for Drift Stone Videography Services." />
  <link rel="stylesheet" href="./styles.css" />
</head>

<body>
  <main class="wrap">

    <header class="header">
      <h1 class="title">Videography Services</h1>
      <p class="sub">Please fill out the form below and I’ll follow up within 48 hours.</p>
    </header>

    <section class="panel" aria-label="Directory">
      <h2 class="h2">Pages</h2>
      <ul class="links">
        <li><a href="./index.html">Home</a></li>
        <li><a href="./work.html">Work</a></li>
        <li><a href="./books.html">Books</a></li>
        <li><a href="./fantasy.html">Fantasy</a></li>
      </ul>
    </section>

    <section class="panel" aria-label="Videography inquiry form">
      <h2 class="h2">Inquiry Form</h2>

      <form
        id="contactForm"
        action="https://formspree.io/f/xdalazpw"
        method="POST"
        class="contactForm"
        novalidate
      >
        <label>
          Name *
          <input type="text" name="name" autocomplete="name" required>
        </label>

        <label>
          Telephone *
          <input type="tel" name="telephone" autocomplete="tel" inputmode="tel" required>
        </label>

        <label>
          Email *
          <input type="email" name="email" autocomplete="email" required>
        </label>

        <label>
          Date of Event *
          <input type="date" name="date_of_event" required>
        </label>

        <!-- Event Type (radio list) -->
        <fieldset class="fieldSet">
          <legend>Event Type *</legend>

          <label class="radioRow">
            <input type="radio" name="event_type" value="Wedding & Pre-Wedding" required>
            <span>Wedding &amp; Pre-Wedding</span>
          </label>

          <label class="radioRow">
            <input type="radio" name="event_type" value="Interview" required>
            <span>Interview</span>
          </label>

          <label class="radioRow">
            <input type="radio" name="event_type" value="Event Videography" required>
            <span>Event Videography</span>
          </label>

          <label class="radioRow">
            <input type="radio" name="event_type" value="Product & Commercial" required>
            <span>Product &amp; Commercial</span>
          </label>

          <label class="radioRow">
            <input type="radio" name="event_type" value="Architectural & Interior" required>
            <span>Architectural &amp; Interior</span>
          </label>

          <label class="radioRow">
            <input type="radio" name="event_type" value="Birthday & Anniversary" required>
            <span>Birthday &amp; Anniversary</span>
          </label>

          <label class="radioRow otherRow">
            <input id="etypeOtherRadio" type="radio" name="event_type" value="Other" required>
            <span>Other:</span>
            <input
              id="etypeOtherText"
              type="text"
              name="event_type_other"
              placeholder="Type here…"
              autocomplete="off"
            >
          </label>
        </fieldset>

        <label>
          Details *
          <textarea name="details" rows="6" required placeholder="Share the key details (location, hours needed, deliverables, vibe, etc.)"></textarea>
        </label>

        <label>
          Promo Code
          <input type="text" name="promo_code" autocomplete="off">
        </label>

        <!-- Honeypot spam filter -->
        <div class="hp" aria-hidden="true">
          <label>
            Leave this field empty
            <input type="text" name="_gotcha" tabindex="-1" autocomplete="off">
          </label>
        </div>

        <button id="submitBtn" type="submit">Send</button>

        <p id="formStatus" class="formStatus" role="status" aria-live="polite"></p>
      </form>
    </section>

    <footer class="footer">
      <p>© <span id="year"></span> Darren Steptoe</p>
    </footer>

  </main>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    (function () {
      const form = document.getElementById("contactForm");
      const statusEl = document.getElementById("formStatus");
      const btn = document.getElementById("submitBtn");

      const otherRadio = document.getElementById("etypeOtherRadio");
      const otherText = document.getElementById("etypeOtherText");

      function setStatus(msg, kind) {
        statusEl.textContent = msg || "";
        statusEl.dataset.kind = kind || "";
      }

      function disableForm(disabled) {
        btn.disabled = disabled;
        Array.from(form.elements).forEach(el => {
          if (el.tagName === "BUTTON") return;
          el.disabled = disabled;
        });
      }

      // If user types in "Other" text, auto-select Other radio
      otherText.addEventListener("input", () => {
        if (otherText.value.trim()) otherRadio.checked = true;
      });

      // If user selects a non-Other option, clear Other text
      form.addEventListener("change", (e) => {
        if (e.target && e.target.name === "event_type" && e.target !== otherRadio) {
          otherText.value = "";
        }
      });

      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        // Required validation
        const requiredEls = form.querySelectorAll("[required]");
        for (const el of requiredEls) {
          if (el.type === "radio") continue;
          if (!String(el.value || "").trim()) {
            setStatus("Please fill out all required fields (*).", "error");
            el.focus();
            return;
          }
        }

        // Required radio group check
        const picked = form.querySelector('input[name="event_type"]:checked');
        if (!picked) {
          setStatus("Please select an Event Type (*).", "error");
          return;
        }

        // If Other selected, require the text box
        if (picked === otherRadio && !otherText.value.trim()) {
          setStatus("Please fill in the “Other” event type.", "error");
          otherText.focus();
          return;
        }

        // Honeypot hit -> silently drop
        const gotcha = form.querySelector('input[name="_gotcha"]');
        if (gotcha && gotcha.value.trim()) {
          form.reset();
          setStatus("✅ Submitted. I’ll follow up within 48 hours.", "success");
          return;
        }

        setStatus("Sending…", "info");
        disableForm(true);

        try {
          const data = new FormData(form);

          // Optional: include a combined human-friendly field too
          if (picked === otherRadio) {
            data.set("event_type", "Other: " + otherText.value.trim());
          }

          const res = await fetch(form.action, {
            method: "POST",
            body: data,
            headers: { "Accept": "application/json" }
          });

          if (res.ok) {
            form.reset();
            setStatus("✅ Submitted. I’ll follow up within 48 hours.", "success");
          } else {
            let errMsg = "Something went wrong. Please try again.";
            try {
              const json = await res.json();
              if (json && json.errors && json.errors.length) {
                errMsg = json.errors.map(e => e.message).join(" ");
              }
            } catch (_) {}
            setStatus(errMsg, "error");
          }
        } catch (err) {
          setStatus("Network error. Please try again in a moment.", "error");
        } finally {
          disableForm(false);
        }
      });
    })();
  </script>

</body>
</html>
