<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calculator — Darren Steptoe</title>
  <meta name="description" content="Calculator tool." />

  <!-- Keep it out of search engines -->
  <meta name="robots" content="noindex, nofollow, noarchive" />
  <meta name="referrer" content="strict-origin-when-cross-origin" />
  <meta name="color-scheme" content="light dark" />

  <!-- Your site CSS (leave as-is) -->
  <link rel="stylesheet" href="./styles.css" />

  <style>
    /* ==========================================================================
       Calculator page — scoped styles only
       ========================================================================== */

    .calc-page {
      min-height: 100vh;
      display: grid;
      place-items: center;
      padding: 28px 16px 18px;
    }

    .calc-wrap {
      width: min(420px, 100%);
    }

    .calc-title {
      margin: 0 0 12px;
      text-align: center; /* centers title */
      font-weight: 800;
      letter-spacing: 0.2px;
      font-size: 18px;
    }

    .calc-card {
      background: var(--panel, #fff);
      border: 1px solid var(--panel-border, rgba(17,17,17,0.12));
      border-radius: 22px;
      box-shadow: var(--panel-shadow, 0 12px 30px rgba(0,0,0,0.08));
      padding: 18px;
    }

    .calc-display {
      width: 100%;
      border: 0;
      outline: none;
      border-radius: 999px;
      padding: 14px 18px;
      text-align: right;
      font-weight: 800;
      font-size: 22px; /* slightly smaller for safety */
      letter-spacing: 0.5px;
      background: #1f86ff;
      color: #fff;
      box-shadow: 0 10px 20px rgba(31,134,255,0.22);
      /* protects layout if number gets longer than expected */
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .calc-pad {
      margin-top: 18px;
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 14px; /* THIS is the main “no touching” fix */
      align-items: center;
      justify-items: center;
    }

    .calc-btn {
      -webkit-tap-highlight-color: transparent;
      width: 66px;
      height: 66px;
      border-radius: 999px;
      border: 0;
      cursor: pointer;
      font-weight: 800;
      font-size: 18px;
      display: grid;
      place-items: center;
      box-shadow: 0 10px 18px rgba(0,0,0,0.06);
      transition: transform 0.06s ease, box-shadow 0.12s ease;
      user-select: none;
    }
    .calc-btn:active {
      transform: translateY(1px);
      box-shadow: 0 7px 14px rgba(0,0,0,0.06);
    }
    .calc-btn:focus-visible {
      outline: 3px solid var(--focus-ring, rgba(17,17,17,0.90));
      outline-offset: 2px;
    }

    /* Button styles */
    .b-fn { background: rgba(200, 210, 230, 0.35); color: var(--fg, #111); }
    .b-num { background: rgba(200, 210, 230, 0.55); color: var(--fg, #111); }
    .b-op-clear { background: #1d2b55; color: #fff; }
    .b-op-sub { background: #ff3b5c; color: #fff; }
    .b-op-div { background: #1f86ff; color: #fff; }
    .b-op-mul { background: #ffc300; color: #1a1a1a; }
    .b-op-add { background: #4fd06b; color: #0b1a10; }

    /* Make bottom row feel airy */
    .calc-pad .row-gap {
      margin-top: 2px;
    }

    /* Keep it clean on small screens */
    @media (max-width: 380px) {
      .calc-card { padding: 16px; border-radius: 20px; }
      .calc-display { font-size: 20px; padding: 13px 16px; }
      .calc-pad { gap: 12px; }
      .calc-btn { width: 62px; height: 62px; font-size: 17px; }
    }

    /* Footer */
    .calc-footer {
      margin-top: 12px;
      text-align: center;
      font-size: 12px;
      color: var(--muted, #444);
      opacity: 0.9;
    }
  </style>
</head>

<body>
  <main class="calc-page">
    <div class="calc-wrap">
      <h1 class="calc-title">Calculator</h1>

      <section class="calc-card" aria-label="Calculator">
        <input id="display" class="calc-display" type="text" inputmode="numeric" autocomplete="off" value="0" readonly />

        <div class="calc-pad" role="group" aria-label="Calculator keypad">
          <!-- Row 1 -->
          <button class="calc-btn b-fn" data-action="percent" aria-label="Percent">%</button>
          <button class="calc-btn b-fn" data-action="sqrt" aria-label="Square root">√</button>
          <button class="calc-btn b-fn" data-action="ce" aria-label="Clear entry">CE</button>
          <button class="calc-btn b-op-clear" data-action="clear" aria-label="Clear">C</button>

          <!-- Row 2 -->
          <button class="calc-btn b-num" data-num="7">7</button>
          <button class="calc-btn b-num" data-num="8">8</button>
          <button class="calc-btn b-num" data-num="9">9</button>
          <button class="calc-btn b-op-sub" data-op="-" aria-label="Minus">−</button>

          <!-- Row 3 -->
          <button class="calc-btn b-num" data-num="4">4</button>
          <button class="calc-btn b-num" data-num="5">5</button>
          <button class="calc-btn b-num" data-num="6">6</button>
          <button class="calc-btn b-op-div" data-op="/" aria-label="Divide">÷</button>

          <!-- Row 4 -->
          <button class="calc-btn b-num" data-num="1">1</button>
          <button class="calc-btn b-num" data-num="2">2</button>
          <button class="calc-btn b-num" data-num="3">3</button>
          <button class="calc-btn b-op-mul" data-op="*" aria-label="Multiply">×</button>

          <!-- Row 5 -->
          <button class="calc-btn b-num row-gap" data-num="." aria-label="Decimal">.</button>
          <button class="calc-btn b-num row-gap" data-num="0">0</button>
          <button class="calc-btn b-fn row-gap" data-action="equals" aria-label="Equals">=</button>
          <button class="calc-btn b-op-add row-gap" data-op="+" aria-label="Plus">+</button>
        </div>
      </section>

      <div class="calc-footer">© <span id="year"></span> Darren Steptoe. All rights reserved.</div>
    </div>
  </main>

  <script>
    (function () {
      const display = document.getElementById("display");
      const year = document.getElementById("year");
      year.textContent = new Date().getFullYear();

      let current = "0";
      let prev = null;
      let op = null;
      let justEvaluated = false;

      function setDisplay(val) {
        display.value = val;
      }

      function normalizeNumberString(s) {
        // Prevent weird strings; keep it clean
        if (s === "" || s === "-") return s;
        const n = Number(s);
        if (!isFinite(n)) return "0";
        // Keep precision sane
        const out = Math.abs(n) >= 1e9 ? n.toExponential(6) : String(n);
        return out;
      }

      function inputNum(ch) {
        if (justEvaluated) {
          current = "0";
          justEvaluated = false;
        }

        if (ch === ".") {
          if (!current.includes(".")) current += ".";
          return;
        }

        if (current === "0") current = ch;
        else current += ch;

        // Soft cap for your stated needs (still safe if exceeded because of ellipsis)
        if (current.replace("-", "").replace(".", "").length > 12) {
          current = current.slice(0, current.length - 1);
        }
      }

      function clearAll() {
        current = "0";
        prev = null;
        op = null;
        justEvaluated = false;
      }

      function clearEntry() {
        current = "0";
      }

      function applyOp(nextOp) {
        const currNum = Number(current);
        if (prev === null) {
          prev = currNum;
        } else if (op) {
          prev = compute(prev, currNum, op);
        }
        op = nextOp;
        current = "0";
        justEvaluated = false;
      }

      function compute(a, b, oper) {
        switch (oper) {
          case "+": return a + b;
          case "-": return a - b;
          case "*": return a * b;
          case "/": return b === 0 ? 0 : a / b;
          default: return b;
        }
      }

      function equals() {
        if (op === null || prev === null) return;
        const result = compute(prev, Number(current), op);
        const out = normalizeNumberString(String(result));
        setDisplay(out);
        current = out;
        prev = null;
        op = null;
        justEvaluated = true;
      }

      function percent() {
        const n = Number(current);
        if (!isFinite(n)) return;
        const out = normalizeNumberString(String(n / 100));
        current = out;
      }

      function sqrt() {
        const n = Number(current);
        if (!isFinite(n) || n < 0) return;
        const out = normalizeNumberString(String(Math.sqrt(n)));
        current = out;
      }

      document.addEventListener("click", (e) => {
        const btn = e.target.closest("button");
        if (!btn) return;

        const num = btn.getAttribute("data-num");
        const oper = btn.getAttribute("data-op");
        const action = btn.getAttribute("data-action");

        if (num !== null) {
          inputNum(num);
          setDisplay(current);
          return;
        }

        if (oper) {
          applyOp(oper);
          setDisplay(current);
          return;
        }

        if (action === "clear") {
          clearAll();
          setDisplay(current);
          return;
        }

        if (action === "ce") {
          clearEntry();
          setDisplay(current);
          return;
        }

        if (action === "equals") {
          equals();
          return;
        }

        if (action === "percent") {
          percent();
          setDisplay(current);
          return;
        }

        if (action === "sqrt") {
          sqrt();
          setDisplay(current);
          return;
        }
      });

      // init
      setDisplay(current);
    })();
  </script>
</body>
</html>
